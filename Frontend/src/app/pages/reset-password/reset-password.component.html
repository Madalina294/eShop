<!-- reset-password.component.html -->
<div class="reset-password-container">
  <div class="card">
    <h2>{{ "resetPassword.title" | translate }}</h2>
    <p>
      {{ "resetPassword.subtitle" | translate }} <strong>{{ email }}</strong>
    </p>

    <nz-spin
      [nzSpinning]="isLoading()"
      [nzTip]="'resetPassword.resetting' | translate"
    >
      <form
        nz-form
        [formGroup]="resetForm"
        (ngSubmit)="onSubmit()"
        [nzLayout]="'vertical'"
      >
        <nz-form-item>
          <nz-form-label nzRequired>{{
            "resetPassword.resetCodeLabel" | translate
          }}</nz-form-label>
          <nz-form-control
            [nzErrorTip]="'resetPassword.resetCodeError' | translate"
          >
            <input
              nz-input
              formControlName="resetCode"
              [placeholder]="'resetPassword.resetCodePlaceholder' | translate"
              maxlength="6"
              style="text-align: center; font-size: 18px; letter-spacing: 4px"
            />
          </nz-form-control>
        </nz-form-item>

        <nz-form-item>
          <nz-form-label nzRequired>{{
            "resetPassword.newPasswordLabel" | translate
          }}</nz-form-label>
          <nz-form-control [nzErrorTip]="newPasswordError">
            <div class="password-input-wrapper">
              <input
                nz-input
                [type]="newPasswordVisible() ? 'text' : 'password'"
                formControlName="newPassword"
                class="password-input"
              />
              <span
                nz-icon
                [nzType]="newPasswordVisible() ? 'eye' : 'eye-invisible'"
                (click)="newPasswordVisible.set(!newPasswordVisible())"
                class="eye-icon"
              ></span>
            </div>
            <ng-template #newPasswordError let-control>
              <div *ngIf="control.hasError('required')">
                {{ "resetPassword.newPasswordRequired" | translate }}
              </div>
              <div *ngIf="control.hasError('pattern')">
                {{ "resetPassword.newPasswordPattern" | translate }}
              </div>
            </ng-template>
          </nz-form-control>
        </nz-form-item>

        <nz-form-item>
          <nz-form-label nzRequired>{{
            "resetPassword.confirmPasswordLabel" | translate
          }}</nz-form-label>
          <nz-form-control [nzErrorTip]="confirmPasswordError">
            <div class="password-input-wrapper">
              <input
                nz-input
                [type]="confirmPasswordVisible() ? 'text' : 'password'"
                formControlName="confirmPassword"
                class="password-input"
              />
              <span
                nz-icon
                [nzType]="confirmPasswordVisible() ? 'eye' : 'eye-invisible'"
                (click)="confirmPasswordVisible.set(!confirmPasswordVisible())"
                class="eye-icon"
              ></span>
            </div>
            <ng-template #confirmPasswordError let-control>
              <div *ngIf="control.hasError('required')">
                {{ "resetPassword.confirmPasswordRequired" | translate }}
              </div>
              <div *ngIf="resetForm.hasError('passwordsMismatch')">
                {{ "resetPassword.passwordsMismatch" | translate }}
              </div>
            </ng-template>
          </nz-form-control>
        </nz-form-item>

        <nz-form-item>
          <nz-form-control>
            <button
              nz-button
              nzType="primary"
              nzSize="large"
              type="submit"
              [disabled]="resetForm.invalid || isLoading()"
              style="width: 100%"
            >
              {{ "resetPassword.resetButton" | translate }}
            </button>
          </nz-form-control>
        </nz-form-item>
      </form>
    </nz-spin>

    <div class="back-to-profile">
      <a routerLink="/profile" *ngIf="isUserLoggedIn()">{{
        "resetPassword.backToAccount" | translate
      }}</a>
      <a routerLink="/login" *ngIf="!isUserLoggedIn()">{{
        "resetPassword.backToSignIn" | translate
      }}</a>
    </div>
  </div>
</div>
